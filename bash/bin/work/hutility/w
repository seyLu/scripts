#! /bin/bash

source "${_SCRIPTS_PATH}/__init__"

[[ "$_DEBUG" == "true" ]] && set -x

#------------------------------------------------------------------------#
# Hutility specific git alias
#------------------------------------------------------------------------#


function main() {
    [[ $# -eq 0 ]] && help && return;


    choices "$@"
}


function choices() {
    local options=$(
        getopt -o p,f,i: --long push,safe_force_push,interactive_rebase: -- "$@"
    )

    [[ $? -ne 0 ]] && {
        echo "Incorrect options provided"
        exit 1
    }

    eval set -- "${options}"

    while [[ $# -gt 0 ]]; do
        case "$1" in
            -p | --push) git push; break ;;
            -f | --safe_force_push) git push --force-with-lease --force-if-includes; break ;;
            -i | --interactive_rebase) git rebase -i HEAD~"$2"; break ;;
            --) shift; break ;;
            *)  echo "$#"
                echo "hi"
                if [[ $# -eq 1 ]]; then
                    git add .
                    git commit -m "$1"
                else
                    list_config
                fi
                break
                ;;
        esac
    done
}


function help() {
    echo
    echo "Hutility specific git alias"
    echo
}


main "$@"

[[ "$_DEBUG" == "true" ]] && set +x
